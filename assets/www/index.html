<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="viewport"content="initial-scale=1, maximum-scale=1, user-scalable=no, width=device-width"><title></title><link href="lib/ionic/css/ionic.css" rel="stylesheet"><link href="css/app.css" rel="stylesheet"><script src="lib/ionic/js/ionic.bundle.min.js"></script><script src="lib/sha1.js"></script><script src="lib/pouchdb/dist/pouchdb-5.2.1.min.js"></script><script src="lib/pouchdb/dist/pouchdb.load.min.js"></script><!-- <script src="lib/pouchdb-find/dist/pouchdb.find.min.js"></script> --><script src="lib/angular-pouchdb/angular-pouchdb.js"></script><script src="lib/imgcache.js/js/imgcache.js"></script><script src="lib/angular-imgcache/angular-imgcache.js"></script><script src="lib/other-lib/jquery-2.1.3.min.js"></script><!-- <script src="lib/ngtouch/build/ngTouch.min.js"></script> --><!-- cordova script (this will be a 404 during development) --><script src="lib/ngCordova/dist/ng-cordova.min.js"></script><script src="cordova.js"></script><script>angular.module("app","ionic app.controllers app.routes app.services app.directives pouchdb ImgCache ngCordova".split(" ")).config(["$ionicConfigProvider","ImgCacheProvider",function(d,c){c.setOptions({usePersistentCache:!0,useDataURI:!0,skipURIencoding:!0});d.views.swipeBackEnabled(!1);d.scrolling.jsScrolling(!1);d.tabs.position("bottom");d.tabs.style("standard")}]).run(["$ionicPlatform","$cordovaStatusbar","$rootScope","$ionicHistory",function(g,f,h,j){g.ready(function(){window.cordova&&window.cordova.plugins.Keyboard&&(cordova.plugins.Keyboard.hideKeyboardAccessoryBar(!1),cordova.plugins.Keyboard.disableScroll(!0));window.StatusBar&&StatusBar.styleDefault()});h.$on("$stateChangeError",function(l,r,k,o,n,m){console.log("stateChangeError: "+m);l.preventDefault()});ionic.Platform.isAndroid()&&g.registerBackButtonAction(function(){j.backView()?navigator.app.backHistory():HybridBridge.moveToBack()},100)}]);angular.module("app.routes",[]).config(["$stateProvider","$urlRouterProvider",function(d,c){c.otherwise("/root");d.state("root",{url:"/root",controller:"RootCtrl",templateUrl:"templates/root.html"}).state("tabsController",{url:"/tab","abstract":!0,templateUrl:"templates/tabsController.html",resolve:{init:["DBService",function(b){return b.init()}]}}).state("tabsController.stars",{url:"/stars",views:{tab1:{templateUrl:"templates/stars.html",controller:"StarsCtrl"}}}).state("tabsController.moves",{url:"/moves/:playerID, :playerName",resolve:{moves:["$stateParams","DBService",function(b,f){return f.dataFetcher().getMovesByPlayer(b.playerID)}]},views:{tab1:{controller:"MovesCtrl",templateUrl:"templates/moves.html"}}}).state("tabsController.clips",{url:"/clips/:playerID, :moveName, :moveID",resolve:{clips:["$stateParams","DBService",function(b,f){return f.pagination().clips().init(b.playerID,b.moveID)}]},views:{tab1:{controller:"ClipsCtrl",templateUrl:"templates/clips.html"}}}).state("tabsController.players",{url:"/players",views:{tab2:{controller:"PlayersCtrl",templateUrl:"templates/players.html"}}}).state("tabsController.tab2Moves",{url:"/moves2/:playerID, :playerName",resolve:{moves:["$stateParams","DBService",function(b,f){return f.dataFetcher().getMovesByPlayer(b.playerID)}]},views:{tab2:{controller:"Tab2MovesCtrl",templateUrl:"templates/moves.html"}}}).state("tabsController.tab2Clips",{url:"/clips2/:playerID, :moveName, :moveID",resolve:{clips:["$stateParams","DBService",function(b,f){return f.pagination().clips().init(b.playerID,b.moveID)}]},views:{tab2:{controller:"ClipsCtrl",templateUrl:"templates/clips.html"}}}).state("tabsController.news",{url:"/news",views:{tab3:{controller:"NewsCtrl",templateUrl:"templates/news.html"}}}).state("tabsController.plays",{url:"/plays",views:{tab4:{controller:"PlaysCtrl",templateUrl:"templates/plays.html"}}}).state("tabsController.play",{url:"/play/:catID, :catName",resolve:{plays:["$stateParams","DBService",function(b,f){return f.getPlaysByCat(b.catID)}]},views:{tab4:{controller:"PlayCtrl",templateUrl:"templates/play.html"}}}).state("tabsController.skills",{url:"/skills",views:{tab5:{controller:"SkillsCtrl",templateUrl:"templates/skills.html"}}}).state("tabsController.skill",{url:"/skill/:catID, :catName",resolve:{plays:["$stateParams","DBService",function(b,f){return f.getSkillsByCat(b.catID)}]},views:{tab5:{controller:"SkillCtrl",templateUrl:"templates/skill.html"}}})}]);angular.module("app.services",[]).factory("DBService",["$q","$timeout","pouchdb","ErrorService","FileCacheService","NativeService","$window",function(ah,ag,ae,af,ad,aa,ab){function O(b,c){W().then(function(){b.resolve("data prefetched");c&&c()})["catch"](function(a){V();b.reject("Err in getting init data: "+a)})}function Y(b,c){W(!0).then(function(){b.resolve("data prefetched");c&&c()})["catch"](function(a){V();b.reject("Err in getting init data: "+a)})}function W(b){b=[];b.push(o());b.push(j.news().init());return R(b)}function R(a){var b=[];angular.forEach(a,function(c){b.push(c)});return ah.all(b)}function V(){af.showAlert("\u542f\u52a8\u9047\u5230\u95ee\u9898","\u8bf7\u60a8\u91cd\u65b0\u4e0b\u8f7d\u5b89\u88c5\u3002",!1)}function Q(){return j.news().refresh()}function o(a){var b=ah.defer();ac.allDocs({include_docs:!0,startkey:"player",endkey:"player\uffff"}).then(function(c){c=c.rows.map(function(d){return d.doc});if(!a){for(i in c){c[i].star&&Z.starList.push(c[i])}}Z.setPlayerList(c);b.resolve("All players retrieved")})["catch"](function(c){b.reject(c)});return b.promise}function U(b,c){b.push.apply(b,c)}function N(){var a=ah.defer();ac.destroy().then(function(){T();a.resolve("DB recreated")})["catch"](function(){a.reject("DB destroy err")});return a.promise}function T(){ac&&(ac=null);ac=ae.create(P.dbName,{auto_compaction:!1})}function M(){var a=ah.defer();S()?window.resolveLocalFileSystemURL(cordova.file.dataDirectory+"/"+P.file,function(b){b.file(function(c){var d=new FileReader;d.onloadend=function(f){a.resolve(ac.load(this.result))};d.readAsText(c)})},function(b){console.log("FileSystem Error");console.dir(b);a.reject(b)}):a.resolve(ac.load(P.file));return a.promise}function S(){return"undefined"!==typeof cordova||"undefined"!==typeof phonegap}function t(){return ac.put({_id:"_local/DBInstalled",status:"completed"})}ag={};var P={remoteURL:dbString?dbString.split(",")[0]:"http://admin:12341234@localhost:5984/",file:dbString?dbString.split(",")[1]:"db.txt",dbName:dbString?dbString.split(",")[2]:"cliplay_new_db_dev_6_15",dbAdapter:"websql",installFail:!1},ac=null;ab=700<=ab.innerHeight?!0:!1;var L=!1,X=!1,s={postInfo:!1,playInfo:!1,playPost:function(b){var c=!L;1<b.image.length&&!L&&(L=!0,ac.get("_local/DBInstalled").then(function(d){d.hasReadTip=!0;return ac.put(d)}));aa.play(JSON.stringify(b),c)}};ag.firstSync=function(b,c){b&&b()};ag.checkPush=function(){aa.checkPush()};ag.playNews=function(b){b.header=b.name;s.playPost(b)};ag.playClipsByMove=function(b,d,f){ac.get("post_"+b+"_"+d).then(function(c){!c.image instanceof Array?console.log("Image list not retrieved"):(c.header=f,s.playPost(c))})["catch"](function(c){console.log(c)})};ag.getGaleryByPlayer=function(b,c){ac.get("galery_"+b).then(function(d){d.header=c;s.playPost(d)})["catch"](function(d){console.log(e)})};ag.getSkillsByCat=function(a){var b=ah.defer();ac.allDocs({include_docs:!0,startkey:"skill_"+a,endkey:"skill_"+a+"\uffff"}).then(function(c){c=c.rows.map(function(d){return d.doc});b.resolve(c)})["catch"](function(c){b.reject(c)});return b.promise};ag.getPlaysByCat=function(a){var b=ah.defer();ac.allDocs({include_docs:!0,startkey:"plays_"+a,endkey:"plays_"+a+"\uffff"}).then(function(c){c=c.rows.map(function(d){return d.doc});b.resolve(c)})["catch"](function(c){b.reject(c)});return b.promise};ag.list=function(){return Z};ag.dataFetcher=function(){return k};ag.pagination=function(){return j};ag.remoteDB=function(){return g};ag.play=function(){return s};var Z={favoriteList:[],playerList:[],moveList:[],clipList:[],starList:[],newsList:[],playsList:[],skillsList:[],getPlaysList:function(){return this.playsList},setPlaysList:function(b){this.playsList.length=0;U(this.playsList,b)},getSkillsList:function(){return this.skillsList},setSkillsList:function(b){this.skillsList.length=0;U(this.skillsList,b)},getStarList:function(){return this.starList},setClipList:function(b){U(this.clipList,b)},resetClipList:function(){this.clipList.length=0},getClipList:function(){return this.clipList},setNewsList:function(b){U(this.newsList,b)},addNewsList:function(b){var c=this.newsList;c.unshift.apply(c,b)},resetNewsList:function(){this.newsList.length=0},getNewsList:function(){return this.newsList},setMoveList:function(b){this.moveList.length=0;U(this.moveList,b)},getMoveList:function(){return this.moveList},setPlayerList:function(b){this.playerList.length=0;U(this.playerList,b)},getPlayerList:function(){return this.playerList},setFavoriteList:function(b){U(this.favoriteList,b)},resetFavoriteList:function(){this.favoriteList.length=0},getFavoriteList:function(){return this.favoriteList},addFavoriteToList:function(b,f){for(var h=0;h<this.favoriteList.length;h++){if(this.favoriteList[h]._id==b){return}}var d=this;ac.get(b).then(function(c){c.thumb=f;c.favorite=!0;d.favoriteList.unshift(c)})},removeFavoriteFromList:function(b){for(var c=0;c<this.favoriteList.length;c++){if(this.favoriteList[c]._id==b){this.favoriteList.splice(c,1);break}}},getAllPlayers:function(){return o()}},k={getMoves:function(){var a=ah.defer();ac.allDocs({include_docs:!0,startkey:"move",endkey:"move\uffff"}).then(function(b){b=b.rows.map(function(c){return c.doc});Z.setMoveList(b);a.resolve("All moves retrieved")})["catch"](function(b){a.reject(b)});return a.promise},getMovesByPlayer:function(a){var b=ah.defer(),d=[];ac.get(a).then(function(c){d=c.clip_moves;c=[];for(i in d){0<parseInt(d[i])&&c.push(i)}return ac.allDocs({include_docs:!0,keys:c})}).then(function(c){c=c.rows.map(function(f){f.doc.clipQty=d[f.doc._id];f.doc.name=f.doc.move_name;return f.doc});b.resolve(c)})["catch"](function(c){b.reject(c)});return b.promise}},j={clips:function(){return this.clipsPg},favorite:function(){return this.favoritePg},news:function(){return this.newsPg},newsPg:{options:{},end:{noMore:!0},limit:ab?12:7,descending:!0,init:function(){this.options={descending:this.descending,include_docs:!0,limit:this.limit,endkey:"news_",startkey:"news_\uffff"};Z.resetNewsList();this.end.noMore=!0;return this.getNews()},refresh:function(){var m=ah.defer(),r=Z.getNewsList()[0],a=this.options.startkey,n=this.end.noMore;this.options={descending:this.descending,include_docs:!0,limit:this.limit,endkey:"news_",startkey:"news_\uffff"};var p=this,q=p.options,h=p.end;ac.allDocs(q).then(function(b){if(b&&0<b.rows.length){return q.startkey=b.rows[b.rows.length-1].key,b=b.rows.map(function(c){return c.doc}),p.end.noMore=b.length<p.limit?!0:!1,b.length==p.limit&&b.splice(-1,1),b}p.end.noMore=!0;return null}).then(function(c){if(c){var d;c:{d=r._id;for(var u=0,l=c.length,b;u<l;){if(b=u+l>>>1,c[b]._id==d){d=b;break c}else{c[b]._id>d?u=b+1:l=b}}d=-1}-1==d?(Z.resetNewsList(),Z.setNewsList(c)):(0!=d&&(c=c.slice(0,d),Z.addNewsList(c)),q.startkey=a,h.noMore=n)}return !0}).then(function(){m.resolve(!0)})["catch"](function(b){m.reject(b)});return m.promise},more:function(b){this.getNews()["catch"](function(){af.showAlert("\u65e0\u6cd5\u83b7\u53d6\u6570\u636e")})["finally"](function(){b&&b()})},hasNoMore:function(){return this.end},getNews:function(){var d=ah.defer(),f=this,a=f.options;ac.allDocs(a).then(function(b){b&&0<b.rows.length?(a.startkey=b.rows[b.rows.length-1].key,b=b.rows.map(function(c){return c.doc}),f.end.noMore=b.length<f.limit?!0:!1,b.length==f.limit&&b.splice(-1,1),Z.setNewsList(b),d.resolve("More data fetched")):(f.end.noMore=!0,d.resolve("No more data"))})["catch"](function(b){d.reject(b)});return d.promise}},clipsPg:{options:{},end:{noMore:!0},limit:ab?12:7,descending:!0,init:function(b,d){this.options={descending:this.descending,include_docs:!0,limit:this.limit,endkey:"clip_"+b+"_"+d,startkey:"clip_"+b+"_"+d+"\uffff"};Z.resetClipList();this.end.noMore=!0;return this.getClips()},more:function(b){this.getClips()["catch"](function(){af.showAlert("\u65e0\u6cd5\u83b7\u53d6\u6570\u636e")})["finally"](function(){b&&b()})},hasNoMore:function(){return this.end},getClips:function(){var h=ah.defer(),a=this,d=a.options;ac.allDocs(d).then(function(b){if(b&&0<b.rows.length){d.startkey=b.rows[b.rows.length-1].key;var c=[];b=b.rows.map(function(f){c.push(f.doc.local);return f.doc});ac.allDocs({keys:c,include_docs:!0}).then(function(l){for(i in b){var m=l.rows[i];b[i].thumb=m.doc?m.doc.thumb:"";b[i].favorite=m.doc?m.doc.favorite:!1}a.end.noMore=b.length<a.limit?!0:!1;b.length==a.limit&&b.splice(-1,1);Z.setClipList(b);h.resolve("More data fetched")})["catch"](function(f){h.reject(f)})}else{a.end.noMore=!0,h.resolve("No more data")}})["catch"](function(b){h.reject(b)});return h.promise}},favoritePg:{options:{},end:{noMore:!0},limit:ab?12:7,view:"",descending:!0,init:function(){this.view="favorite";this.options={descending:this.descending,limit:this.limit,include_docs:!0,endkey:[!0],startkey:[!0,{}]};this.end.noMore=!0;Z.resetFavoriteList();return this.getFavorite()},search:function(b,d){b||(b={});this.options={descending:this.descending,limit:this.limit,include_docs:!0};b.player&&b.move?(this.view="favorite_player_move",this.options.startkey=[!0,b.player,b.move,{}],this.options.endkey=[!0,b.player,b.move]):b.player?(this.view="favorite_player",this.options.startkey=[!0,b.player,{}],this.options.endkey=[!0,b.player]):b.move?(this.view="favorite_move",this.options.startkey=[!0,b.move,{}],this.options.endkey=[!0,b.move]):(this.view="favorite",this.options.startkey=[!0,{}],this.options.endkey=[!0]);b.noResult?this.options.limit=0:Z.resetFavoriteList();this.end.noMore=!0;this.more(d)},more:function(b){this.getFavorite()["catch"](function(){af.showAlert("\u65e0\u6cd5\u83b7\u53d6\u6570\u636e")})["finally"](function(){b&&b()})},hasNoMore:function(){return this.end},needLoad:function(){return !this.hasNoMore().noMore&&Z.getFavoriteList().length<this.limit?!0:!1},getFavorite:function(){var h=ah.defer(),a=this,d=a.options;ac.query(a.view,d).then(function(b){b&&0<b.rows.length?(d.startkey=b.rows[b.rows.length-1].key,a.end.noMore=b.rows.length<a.limit?!0:!1,b.rows.length==a.limit&&b.rows.splice(-1,1),b=b.rows.map(function(c){return{_id:c.doc._id,name:c.doc.name,desc:c.doc.desc,image:c.doc.image,thumb:c.value.thumb,favorite:c.key[0],local:c.id,player:c.doc.player,move:c.doc.move,timestamp:c.value.timestamp}}),Z.setFavoriteList(b),h.resolve("Favorite retrieved")):(a.end.noMore=!0,h.resolve("No more data"))})["catch"](function(b){h.reject(b)});return h.promise}}},g={syncRemote:function(h,c,l){var m=X;m||c&&c();ac.replicate.from(P.remoteURL+P.dbName,{timeout:5000}).then(function(b){m||(X=!0,ac.get("_local/DBInstalled").then(function(d){d.hasSynced=!0;ac.put(d)}));return 0<b.docs_written?o(!0).then(Q):!0})["catch"](function(b){(S()?navigator.connection.type!==Connection.NONE:1)?af.showAlert("\u65e0\u6cd5\u540c\u6b65\u6700\u65b0\u6570\u636e","\u8bf7\u7a0d\u5019\u518d\u8bd5\u3002",!1):af.showAlert("\u65e0\u6cd5\u540c\u6b65\u6700\u65b0\u6570\u636e","\u8bf7\u786e\u8ba4\u4e92\u8054\u7f51\u8fde\u63a5\u3002",!1)})["finally"](function(){m||l&&l();h&&h()})},change:function(){ac.changes({limit:10,since:73}).then(function(b){console.log(b)})["catch"](function(b){console.log(b)})}};ag.put=function(b){return ac.put(b)};ag.readNews=function(b){b.read||(b.read=!0);return ac.get(b._id).then(function(c){if(c.read){return !0}c.read=!0;return ac.put(c)})};ag.updateBoth=function(f,h,d){ac.get(f).then(function(a){ac.get(a.local).then(function(b){var c=new Date;b.thumb=a.image+".jpg";b.favorite=h;b.timestamp=""+c.getTime();ac.put(b)})["catch"](function(){var b={_id:a.local,type:"local",favorite:h,thumb:a.image+".jpg",clip:f,player:a.player,move:a.move,timestamp:""+(new Date).getTime()};ac.put(b)});h?Z.addFavoriteToList(f,a.image+".jpg"):Z.removeFavoriteFromList(f)});(function(a){if(a&&0<a.length){for(i in a){if(a[i]._id==f){a[i].thumb=a[i].image+".jpg";a[i].favorite=h;break}}}})(d)};ag.updateFavorite=function(f,h,d){ac.get(h).then(function(a){a.favorite=d;a.timestamp=""+(new Date).getTime();ac.put(a);d?Z.addFavoriteToList(f,a.thumb):Z.removeFavoriteFromList(f)})["catch"](function(){ac.get(f).then(function(a){a={_id:h,type:"local",favorite:d,thumb:"",clip:f,player:a.player,move:a.move,timestamp:""+(new Date).getTime()};ac.put(a);Z.addFavoriteToList(f,"")})})};ag.updateThumb=function(f,h){var d=function(a){if(a&&0<a.length){for(i in a){if(a[i]._id==f){a[i].thumb=a[i].image+".jpg";break}}}};ac.get(f).then(function(a){ac.get(a.local).then(function(b){b.thumb=a.image+".jpg";ac.put(b)})["catch"](function(){ac.put({_id:a.local,type:"local",favorite:!1,thumb:a.image+".jpg",clip:f,player:a.player,move:a.move})})});d(Z.getFavoriteList());d(h)};ag.init=function(){var a=ah.defer();T();ac.get("_local/DBInstalled").then(function(b){b.hasReadTip&&(L=!0);b.hasSynced&&(X=!0);O(a)})["catch"](function(b){N().then(M).then(t).then(function(){Y(a)})["catch"](function(c){console.log("install err, details = "+c);P.installFail=!0;af.showAlert("\u542f\u52a8\u9047\u5230\u95ee\u9898","\u8bf7\u60a8\u91cd\u65b0\u4e0b\u8f7d\u5b89\u88c5\u3002",!1);a.reject("Err in creating DB"+c)})});return a.promise};return ag}]).factory("ImgCacheService",["$q","ImgCache",function(f,c){function g(b,d){c.isCached(d,function(h,a){a?c.useCachedFileWithSource(b,d):c.cacheFile(d,function(){c.useCachedFileWithSource(b,d)})})}return{cacheImg:function(h){var d=new Image;g(d,h)}}}]).factory("FileCacheService",["$q","ImgCache",function(f,c){function g(b){var a=f.defer();c.$promise.then(function(){c.cacheFile(b,function(){a.resolve("file downloaded")},function(){a.resolve("file not downloaded")})});return a.promise}return{download:function(b){var a=f.defer();c.$promise.then(function(){c.cacheFile(b,function(){c.getCachedFileURL(b,function(d,h){a.resolve(h)})},function(){a.reject("download file error")},function(d){$("#progress").val(d.loaded/d.total)})});return a.promise},cacheFiles:function(d){var a=[];angular.forEach(d,function(b){a.push(g(b.image))});return f.all(a)},cacheAvatar:function(d){var a=[];angular.forEach(d,function(b){a.push(g(b.avatar));b.star&&a.push(g(b.image))});return f.all(a)}}}]).factory("NativeService",function(){var f={},c=function(b){},g=function(b){console.log(b)};f.play=function(b,d){HybridBridge.showList(b,d,c,g)};f.checkPush=function(){HybridBridge.checkPush()};f.showMessage=function(j,h,k){k||(k=!1);HybridBridge.showAlert(j,h,k)};f.showFavorite=function(){HybridBridge.showFavorite()};return f}).factory("ErrorService",["$rootScope","$cordovaSplashscreen","$ionicPopup","$ionicLoading","$timeout","NativeService",function(k,h,o,p,n,g){var j={showSplashScreen:function(){h.show()},hideSplashScreen:function(){n(function(){h.hide()})},showProgress:function(){n(function(){h.addProgress()},10)},showAlert:function(f,d,l){g.showMessage(f,d?d:"\u8bf7\u7a0d\u540e\u91cd\u8bd5",l)},showDownLoader:function(){p.show({template:'<span>Downloading...</span><progress max="1" id="progress"></progress>',hideOnStateChange:!0})},showLoader:function(b){p.show({template:"\u5b89\u88c5\u6700\u65b0\u6570\u636e...",hideOnStateChange:!1,duration:b?b:0})},hideLoader:function(b){p.hide();b&&j.showAlert(b)}};return j}]);angular.module("app.controllers",[]).controller("RootCtrl",["$scope","$state","$timeout","$ionicHistory",function(h,g,k,l){function j(){g.go("tabsController.news")}j();h.retry=function(){j()};ionic.Platform.isAndroid()&&l.nextViewOptions({disableAnimate:!0,disableBack:!0})}]).controller("StarsCtrl",["$scope","$ionicSlideBoxDelegate","$state","ErrorService","DBService",function(h,g,k,l,j){h.stars=j.list().getStarList();g.update();g.slide(0);h.showMoves=function(d,c){j.getGaleryByPlayer(d,c)}}]).controller("ClipsCtrl",["$scope","$stateParams","$ionicListDelegate","DBService","NativeService",function(j,h,l,n,k){function g(a){n.updateFavorite(j.clips[a]._id,j.clips[a].local,!j.clips[a].favorite);j.clips[a].favorite=!j.clips[a].favorite}j.clips=n.list().getClipList();j.noMoreItemsAvailable=n.pagination().clips().hasNoMore();j.listCanSwipe=!0;j.playerName=h.playerName;j.moveName=h.moveName;j.playingClipIndex="";j.loadMore=function(){n.pagination().clips().more(function(){j.$broadcast("scroll.infiniteScrollComplete")})};j.play=function(a){j.playingClipIndex=a;k.playAnimation(j.clips[a].image,j.clips[a].favorite,!0)};j.updateFavorite=function(b){l.closeOptionButtons();g(b)};j.updateFavoriteFromNative=function(){g(j.playingClipIndex)};j.updateThumbFromNative=function(a){"download"!==a&&j.clips[j.playingClipIndex].thumb||n.updateThumb(j.clips[j.playingClipIndex]._id,j.clips)};j.updateBothFromNative=function(a){"download"!==a&&j.clips[j.playingClipIndex].thumb?g(j.playingClipIndex):n.updateBoth(j.clips[j.playingClipIndex]._id,!j.clips[j.playingClipIndex].favorite,j.clips)}}]).controller("FavorateCtrl",["$scope","$state","$ionicScrollDelegate","$ionicListDelegate","$ionicPopover","ErrorService","DBService","NativeService","$timeout",function(t,s,o,r,n,j,k,u,h){t.listCanSwipe=!0;t.playingClipIndex="";t.clips=[];t.search={selected_player:"",selected_move:"",by_player:"",by_move:""};t.data={players:k.list().getPlayerList(),moves:k.list().getMoveList()};n.fromTemplateUrl("templates/popover.html",{scope:t}).then(function(a){t.popover=a});t.openPopover=function(a){t.search.by_player=t.search.selected_player;t.search.by_move=t.search.selected_move;t.popover.show(a)};t.filter=function(){j.showLoader();o.scrollTop();var a={player:t.search.by_player,move:t.search.by_move};t.search.selected_player=t.search.by_player;t.search.selected_move=t.search.by_move;k.pagination().favorite().search(a,function(){j.hideLoader()});t.popover.hide()};t.loadMore=function(){k.pagination().favorite().more(function(){t.$broadcast("scroll.infiniteScrollComplete")})};t.play=function(a){t.playingClipIndex=a;u.playAnimation(t.clips[a].image,t.clips[a].favorite,!1)};t.removeFavorite=function(a){r.closeOptionButtons();k.updateFavorite(t.clips[a]._id,t.clips[a].local,!1);k.pagination().favorite().needLoad()&&t.loadMore()};t.updateThumbFromNative=function(a){"download"!==a&&t.clips[t.playingClipIndex].thumb||k.updateThumb(t.clips[t.playingClipIndex]._id,null)};var g=k.list().getFavoriteList().length;g&&j.showLoader();h(function(){t.noMoreItemsAvailable=k.pagination().favorite().hasNoMore();t.clips=k.list().getFavoriteList();g&&j.hideLoader()},300)}]).controller("PlayersCtrl",["$scope","$state","DBService","ErrorService","$timeout",function(h,g,k,l,j){h.players=k.list().getPlayerList();h.showMoves=function(b,d){g.go("tabsController.tab2Moves",{playerID:b,playerName:d})};h.myFilter=function(b){return 4<b.clip_total}}]).controller("MovesCtrl",["$scope","$stateParams","moves","DBService",function(g,f,h,j){g.moves=h;g.playerName=f.playerName;g.showClips=function(b,c){j.playClipsByMove(f.playerID,c,b)}}]).controller("Tab2MovesCtrl",["$scope","$stateParams","moves","DBService",function(g,f,h,j){g.moves=h;g.playerName=f.playerName;g.showClips=function(b,c){j.playClipsByMove(f.playerID,c,b)}}]).controller("NewsCtrl",["$scope","$state","$stateParams","DBService","ErrorService","$timeout","NativeService","$ionicScrollDelegate",function(r,q,n,o,k,h,j,s){r.noMoreItemsAvailable=o.pagination().news().hasNoMore();r.news=o.list().getNewsList();k.hideSplashScreen();var g=!0;r.loadMore=function(){o.pagination().news().more(function(){r.$broadcast("scroll.infiniteScrollComplete")})};r.showClips=function(a){o.playNews(r.news[a])};r.doRefresh=function(){o.remoteDB().syncRemote(function(){r.$broadcast("scroll.refreshComplete");g&&(o.checkPush(),g=!1)},function(){k.showLoader()},function(){k.hideLoader()})};r.cleanCache=function(){k.showAlert("\u5220\u9664\u5df2\u4e0b\u8f7d\u77ed\u7247","\u91ca\u653e\u78c1\u76d8\u7a7a\u95f4",!0)};r.showFavorite=function(){j.showFavorite()};r.$on("$ionicView.loaded",function(){h(function(){r.$broadcast("scroll.refreshStart")},300)})}]).controller("PlaysCtrl",["$scope","$state","DBService",function(f,c,g){f.cats=g.list().getPlaysList();f.myFilter=function(b){return 0<b.quantity};f.showPlays=function(b,d){c.go("tabsController.play",{catID:b,catName:d})}}]).controller("PlayCtrl",["$scope","$stateParams","DBService","plays",function(g,f,h,j){g.plays=j;g.catName=f.catName;g.playPlay=function(b){h.play().playPlay(b.image)}}]).controller("SkillsCtrl",["$scope","$state","DBService",function(f,c,g){f.cats=g.list().getSkillsList();f.myFilter=function(b){return 0<b.count};f.showSkills=function(b,d){c.go("tabsController.skill",{catID:b,catName:d})}}]).controller("SkillCtrl",["$scope","$stateParams","DBService","plays",function(g,f,h,j){g.skills=j;g.catName=f.catName;g.play=function(b){h.play().playArticle(b)}}]);angular.module("app.directives",[]).directive("blankDirective",[function(){}]).directive("backImg",function(){return function(f,c,g){c.css({"background-image":"url("+g.backImg+")"})}}).directive("hideTabs",["$rootScope",function(b){return{restrict:"A",link:function(a,f,g){a.$on("$ionicView.beforeEnter",function(){a.$watch(g.hideTabs,function(c){b.hideTabs=c})})}}}]);angular.element(document).ready(function(){window.cordova?(console.log("Running in Cordova, will bootstrap AngularJS once 'deviceready' event fires."),document.addEventListener("deviceready",function(){console.log("Deviceready event has fired, bootstrapping AngularJS.");startForIOS()},!1)):(console.log("Running in browser, bootstrapping AngularJS now."),angular.bootstrap(document.body,["app"]))});var dbString="";function startForIOS(){HybridBridge.getDBString(function(b){dbString=b;angular.bootstrap(document.body,["app"])},function(b){console.log("Hybrid Bridge Error"+b)})}function test(){angular.element(document.getElementById("ClipsScopeID")).injector().get("DBService").list().getPlayerList()}function updateClip(f,c,g){"clip"===g?(g=angular.element(document.getElementById("ClipsScopeID")).scope(),""!==c?"favorite"===f?g.updateBothFromNative(c):g.updateThumbFromNative(c):"favorite"===f&&g.updateFavoriteFromNative()):""!==c&&(g=angular.element(document.getElementById("FavoriteScopeID")).scope(),g.updateThumbFromNative(c))}function retryInstall(){angular.element(document.getElementById("RootScopeID")).scope().retry()};</script></head><body animation="slide-left-right-ios7" class="platform-android platform-cordova platform-webview"><ion-nav-bar class="bar-light" align-title="center"></ion-nav-bar><ion-nav-view></ion-nav-view></body></html>